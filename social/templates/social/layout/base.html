{% load static %} <!-- Carrega a tag static do Django para uso de arquivos estáticos -->
<!DOCTYPE html>
<html lang="pt-br" class="scroll-smooth"> <!-- Define idioma e scroll suave -->
<head>
    <meta charset="UTF-8"> <!-- Codificação de caracteres -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- Responsividade -->
    <title>NioCortex - YourLife+</title> <!-- Título da página -->
    
    <!-- Tailwind CSS via CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Alpine.js para interações reativas -->
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.13.3/dist/cdn.min.js"></script>

    <!-- Ícones Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

    <!-- Fontes Google -->
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&family=Outfit:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    
    <script>
        /* Configuração customizada do Tailwind */
        tailwind.config = {
            darkMode: 'class', // Ativa modo escuro por classe
            theme: {
                extend: {
                    // Fontes personalizadas
                    fontFamily: { 
                        sans: ['Plus Jakarta Sans', 'sans-serif'], 
                        display: ['Outfit', 'sans-serif'] 
                    },
                    // Paleta de cores
                    colors: { 
                        primary: '#7c3aed', 
                        secondary: '#0ea5e9', 
                        text: '#1e293b' 
                    },
                    // Animações customizadas
                    animation: { 
                        float: 'float 6s ease-in-out infinite',
                        'pulse-gold': 'pulse-gold 2s infinite'
                    },
                    // Keyframes das animações
                    keyframes: { 
                        float: { 
                            '0%, 100%': { transform: 'translateY(0)' }, 
                            '50%': { transform: 'translateY(-10px)' } 
                        }
                    }
                }
            }
        }
    </script>
    
    <style>
        /* --- TEMAS (VARIÁVEIS CSS) --- */

        /* Tema padrão / aurora */
        :root, body.theme-aurora { 
            --bg-body: #f8fafc; 
            --bg-card: rgba(255, 255, 255, 0.9); 
            --text-main: #1e293b; 
            --text-muted: #64748b; 
            --primary: #7c3aed; 
            --border-color: rgba(255, 255, 255, 0.6); 
        }

        /* Tema masculino escuro */
        body.theme-male-dark { 
            --bg-body: #0f172a; 
            --bg-card: rgba(30, 41, 59, 0.95); 
            --text-main: #f8fafc; 
            --text-muted: #94a3b8; 
            --primary: #3b82f6; 
            --border-color: rgba(255, 255, 255, 0.1); 
        }

        /* Tema feminino escuro */
        body.theme-female-dark { 
            --bg-body: #18181b; 
            --bg-card: rgba(39, 39, 42, 0.95); 
            --text-main: #f4f4f5; 
            --text-muted: #a1a1aa; 
            --primary: #ec4899; 
            --border-color: rgba(255, 255, 255, 0.1); 
        }

        /* Tema masculino premium */
        body.theme-male-premium { 
            --bg-body: #022c22; 
            --bg-card: rgba(6, 78, 59, 0.95); 
            --text-main: #ecfdf5; 
            --text-muted: #6ee7b7; 
            --primary: #fbbf24; 
            --border-color: rgba(251, 191, 36, 0.3); 
        }

        /* Tema feminino premium */
        body.theme-female-premium { 
            --bg-body: #450a0a; 
            --bg-card: rgba(127, 29, 29, 0.95); 
            --text-main: #fff1f2; 
            --text-muted: #fca5a5; 
            --primary: #fbbf24; 
            --border-color: rgba(251, 191, 36, 0.3); 
        }

        /* --- ACESSIBILIDADE --- */

        /* Alto contraste */
        body.access-high-contrast { 
            --bg-body: #000!important; 
            --bg-card: #000!important; 
            --text-main: #ff0!important; 
            --text-muted: #fff!important; 
            --primary: #0ff!important; 
            --border-color: #fff!important; 
        }

        /* Texto grande */
        body.access-large-text { font-size: 115%; }

        /* Fonte amigável para dislexia */
        body.access-dyslexic { 
            font-family: 'Comic Sans MS', sans-serif !important; 
        }

        /* Layout compacto */
        body.access-compact .p-4, 
        body.access-compact .p-5 { 
            padding: 0.5rem !important; 
        }

        /* Componentes com efeito glassmorphism */
        .glass-nav { 
            background: var(--bg-card); 
            backdrop-filter: blur(20px); 
            border-bottom: 1px solid var(--border-color); 
        }

        .glass-panel { 
            background: var(--bg-card); 
            backdrop-filter: blur(16px); 
            border: 1px solid var(--border-color); 
            box-shadow: 0 4px 30px rgba(0,0,0,0.05); 
        }

        /* Esconde elementos até Alpine inicializar */
        [x-cloak] { display: none !important; }

        /* Variáveis globais adicionais */
        :root {
            --color-primary: #7c3aed;
            --color-secondary: #0ea5e9;
            --bg-body: #f8fafc;
            --gradient-sidebar: linear-gradient(135deg, #7c3aed 0%, #0ea5e9 100%);
        }

        /* Drawer lateral */
        .glass-drawer {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(25px);
            border-left: 1px solid rgba(255, 255, 255, 0.5);
            box-shadow: -10px 0 30px rgba(0, 0, 0, 0.1);
        }

        /* Oculta scrollbar */
        .scrollbar-hide::-webkit-scrollbar { display: none; }
        .scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }
    </style>

    <!-- Bloco extra para CSS adicional -->
    {% block extra_css %}{% endblock %}

<style>
    /* Importando Fonte Moderna */
    @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap');

    :root {
        --glass-bg: rgba(255, 255, 255, 0.75);
        --glass-border: rgba(255, 255, 255, 0.6);
        --primary-glow: #8b5cf6;
    }

    body {
        font-family: 'Plus Jakarta Sans', sans-serif !important;
        background-color: #f8fafc; /* Slate-50 */
    }

    /* Animação Aurora (Blobs) */
    .aurora-container {
        position: fixed;
        top: 0; left: 0; width: 100%; height: 100%;
        z-index: -1;
        overflow: hidden;
        pointer-events: none;
    }
    
    .blob {
        position: absolute;
        border-radius: 50%;
        filter: blur(80px);
        opacity: 0.4;
        animation: floatBlob 10s infinite alternate;
    }
    
    .blob-1 { top: -10%; left: 20%; width: 500px; height: 500px; background: #c4b5fd; animation-delay: 0s; }
    .blob-2 { bottom: -10%; right: 20%; width: 400px; height: 400px; background: #f0abfc; animation-delay: 2s; } /* Default Rosa */
    .blob-3 { top: 40%; left: 40%; width: 300px; height: 300px; background: #a78bfa; animation-delay: 4s; }

    .blob-blue { background: #93c5fd !important; } /* Azul para Homens */

    @keyframes floatBlob {
        0% { transform: translate(0, 0) scale(1); }
        100% { transform: translate(20px, -20px) scale(1.1); }
    }

    /* Glassmorphism Classes (Forçando visual se Tailwind falhar) */
    .glass-panel {
        background: var(--glass-bg) !important;
        backdrop-filter: blur(16px) !important;
        -webkit-backdrop-filter: blur(16px) !important;
        border: 1px solid var(--glass-border) !important;
        box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.05) !important;
    }
    
    .nav-bottom-glass {
        background: rgba(255, 255, 255, 0.9) !important;
        backdrop-filter: blur(20px);
        border-top: 1px solid rgba(255,255,255,0.5);
    }
</style>


<style>
    /* Remover Scrollbar dos Stories mas manter scroll */
    .no-scrollbar::-webkit-scrollbar { display: none; }
    .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

    /* Animação de Like (Heart Burst) */
    @keyframes like-bounce {
        0% { transform: scale(1); }
        25% { transform: scale(1.2); }
        50% { transform: scale(0.95); }
        100% { transform: scale(1); }
    }
    .animate-like { animation: like-bounce 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); }

    /* Efeito de Vidro Profundo */
    .glass-deep {
        background: rgba(255, 255, 255, 0.65);
        backdrop-filter: blur(12px);
        -webkit-backdrop-filter: blur(12px);
        border: 1px solid rgba(255, 255, 255, 0.5);
        box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.05);
    }
    
    /* Gradiente suave para bordas ativas */
    .gradient-border {
        position: relative;
        background: linear-gradient(white, white) padding-box,
                    linear-gradient(45deg, #8b5cf6, #ec4899) border-box;
        border: 2px solid transparent;
        border-radius: 1rem;
    }
</style>

</head>

<body 
    x-data="{ sidebarOpen: false, profileOpen: false, consciosOpen: false, talkioOpen: false }" 
    class="relative flex flex-col min-h-screen overflow-x-hidden font-sans antialiased"
    style="background-color: var(--bg-body);"
>
<div class="aurora-container">
    <div class="blob blob-1"></div>
    
    {% if request.user.sexo == 'M' or request.user.gender == 'M' %}
        <div class="blob blob-2 blob-blue"></div> {% else %}
        <div class="blob blob-2"></div> {% endif %}
    
    <div class="blob blob-3"></div>
</div>

    <div class="fixed inset-0 w-full h-full overflow-hidden pointer-events-none -z-50 bg-slate-50">
        <div class="absolute top-0 rounded-full left-1/4 w-96 h-96 bg-brand-300 mix-blend-multiply filter blur-3xl opacity-30 animate-blob"></div>
        
        {% if request.user.sexo == 'M' or request.user.gender == 'M' %}
            <div class="absolute top-0 bg-blue-300 rounded-full right-1/4 w-96 h-96 mix-blend-multiply filter blur-3xl opacity-30 animate-blob animation-delay-2000"></div>
        {% else %}
            <div class="absolute top-0 bg-pink-300 rounded-full right-1/4 w-96 h-96 mix-blend-multiply filter blur-3xl opacity-30 animate-blob animation-delay-2000"></div>
        {% endif %}
        
        <div class="absolute bg-purple-300 rounded-full -bottom-8 left-1/3 w-96 h-96 mix-blend-multiply filter blur-3xl opacity-30 animate-blob animation-delay-4000"></div>
    </div>
    
    {% include "components/global_loader.html" %}
    <!-- Efeitos de fundo com blobs animados -->
    <div class="fixed inset-0 z-0 pointer-events-none">
        <div class="absolute top-[-10%] left-[20%] w-[800px] h-[800px] rounded-full mix-blend-multiply filter blur-[120px] opacity-20 animate-float" style="background-color: var(--color-primary)"></div>
        <div class="absolute bottom-[10%] right-[10%] w-[600px] h-[600px] rounded-full mix-blend-multiply filter blur-[120px] opacity-20 animate-float" style="animation-delay: 2s; background-color: var(--color-secondary)"></div>
    </div>

    <!-- Navbar fixa no topo -->
    <nav class="sticky top-0 z-40 w-full px-4 py-2 shadow-sm glass-nav">
        <div class="flex items-center justify-between h-16 mx-auto max-w-7xl">
            
            <!-- Seção esquerda da navbar -->
            {% include 'social/components/navbar/left.html' %}

            <!-- Seção central da navbar -->
            {% include 'social/components/navbar/center.html' %}

            <!-- Seção direita da navbar -->
            {% include 'core/components/navbar/right.html' %}

            <!-- Drawers da navbar -->
            {% include 'social/components/navbar/drawers.html' %} 
        </div>
    </nav>

    <!-- Conteúdo principal -->
    <div class="relative z-10 flex-1 w-full px-4 pt-6 pb-20 mx-auto max-w-7xl">
        {% block content %}{% endblock %}
    </div>

    <!-- Drawer do Talkio -->
    <div 
        x-show="talkioOpen" 
        x-transition:enter="transition ease-out duration-300" 
        x-transition:enter-start="translate-x-full" 
        x-transition:enter-end="translate-x-0" 
        x-transition:leave="transition ease-in duration-300" 
        x-transition:leave-start="translate-x-0" 
        x-transition:leave-end="translate-x-full" 
        class="fixed inset-y-0 right-0 z-[60] w-full md:w-[400px] glass-drawer flex flex-col shadow-2xl" 
        style="display: none;" 
        x-cloak
    >
        <!-- Cabeçalho do Talkio -->
        <div class="flex items-center justify-between px-5 py-4 border-b border-slate-200/50 bg-white/40 backdrop-blur-sm">
            <div class="flex items-center gap-3">
                <img src="{% static 'imgs/talkio/Talkio_logo.png' %}" class="object-contain w-8 h-8">
                <h3 class="font-bold text-slate-800">Talkio</h3>
            </div>
            <!-- Botão de fechar -->
            <button @click="talkioOpen = false" class="flex items-center justify-center w-8 h-8 transition rounded-full hover:bg-rose-50 text-slate-500 hover:text-rose-500">
                <i class="fas fa-times"></i>
            </button>
        </div>

        <!-- Conteúdo do Talkio via iframe -->
        <div class="relative flex-1 bg-white/30">
            <iframe src="/core/talkio/" class="absolute inset-0 w-full h-full" frameborder="0"></iframe>
        </div>
    </div>

    <!-- Inclusão extra de drawers -->
    {% include 'social/components/navbar/drawers.html' %}

    <!-- Bloco extra para JS adicional -->
    {% block extra_js %}{% endblock %}
{% include "core/components/module_switcher.html" %}
{% include 'social/layout/nav_bottom.html' %}
</body>
</html>
